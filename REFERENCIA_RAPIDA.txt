#!/bin/bash
# Este es un archivo de referencia r√°pida, no es ejecutable
# √ösalo como cheat sheet de comandos

# üöÄ TABLA DE REFERENCIA R√ÅPIDA - ESTACI√ìN METEOROL√ìGICA

## INICIAR EL SISTEMA
bash start-rpi-optimizado.sh                    # Autom√°tico (recomendado)
docker-compose up -d                           # Manual
docker-compose build && docker-compose up -d  # Desde cero

## ACCESO
http://localhost:8081                          # Dashboard local
http://192.168.1.100:8081                      # Desde otra PC (cambiar IP)
curl http://localhost:8000/health              # Health check

## DETENER/REINICIAR
docker-compose down                            # Detener todo
docker-compose restart                         # Reiniciar
docker-compose logs -f backend                 # Ver logs en vivo

## VERIFICACI√ìN
bash verificador.sh                            # Diagn√≥stico autom√°tico
docker ps                                      # Ver contenedores corriendo
docker-compose ps                              # Ver estado de servicios

## BASE DE DATOS
sqlite3 weather.db                             # Conectar a BD
sqlite3 weather.db ".tables"                   # Ver tablas
cp weather.db weather.db.backup                # Backup
rm weather.db                                  # Limpiar (se recrea)

## ESTAD√çSTICAS
docker stats                                   # Consumo CPU/RAM
ls -lh weather.db                              # Tama√±o de BD
df -h                                          # Espacio disco

## API ENDPOINTS
GET  http://localhost:8000/api/stations/       # Listar estaciones
POST http://localhost:8000/api/stations/       # Crear estaci√≥n
GET  http://localhost:8000/api/stations/{id}   # Ver estaci√≥n
POST http://localhost:8000/api/data/submit     # Enviar datos

## PUERTOS
8000  ‚Üí API Backend
8081  ‚Üí Dashboard Frontend (nginx)
8888  ‚Üí Monitor (si est√° habilitado)

## ARCHIVOS IMPORTANTES
weather.db                      # Base de datos SQLite
.env                           # Variables de entorno
docker-compose.yml             # Configuraci√≥n Docker
Dockerfile.backend             # Imagen Docker
backend/requirements.txt       # Dependencias Python
frontend/index.html            # Dashboard HTML

## SOLUCIONAR PROBLEMAS
# Puerto 8000 ocupado
lsof -i :8000
kill -9 [PID]

# Contenedor no inicia
docker-compose logs backend

# Permisos de Docker
sudo usermod -aG docker $USER
newgrp docker

# BD corrupta
rm weather.db
docker-compose restart

# Espacio bajo
docker system prune
docker image prune

## VARIABLES DE ENTORNO (.env)
DATABASE_URL=sqlite:///weather.db   # Cambia si quieres PostgreSQL
HOST=0.0.0.0
PORT=8000
PYTHONUNBUFFERED=1

## CURL EJEMPLOS

# Crear estaci√≥n
curl -X POST http://localhost:8000/api/stations/ \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Mi Estaci√≥n",
    "location": "Calle Principal 123",
    "latitude": 19.4326,
    "longitude": -99.1332
  }'

# Enviar datos
curl -X POST http://localhost:8000/api/data/submit \
  -H "Content-Type: application/json" \
  -d '{
    "station_id": "ID_AQUI",
    "temperature": 25.5,
    "humidity": 65
  }'

# Listar estaciones
curl http://localhost:8000/api/stations/ | python -m json.tool

## VERSI√ìN & ESTADO
Versi√≥n:    2.0 Optimizada
Framework:  Flask + SQLAlchemy
BD:         SQLite (archivo)
Docker:     Multistage, slim
RAM ideal:  300MB
CPU ideal:  2-3%

## DOCUMENTACI√ìN
INICIO_RAPIDO.md                    # Este archivo simplificado
README_OPTIMIZADO.md                # Documentaci√≥n t√©cnica
GUIA_REGISTRAR_ESTACION.md         # Gu√≠a usuario (sin tecnicismos)
CAMBIOS_OPTIMIZACION.md            # Detalles de cambios
ESP32_CLOUDFLARE_DUCKDNS.ino       # C√≥digo del sensor

---
Guarda este archivo como favorito en tu editor para referencia r√°pida
