# ğŸ“ RASPBERRY PI 8GB - GUÃA RÃPIDA

**Tu proyecto estÃ¡ completamente optimizado para Raspberry Pi 8GB**

---

## âš¡ InstalaciÃ³n en 3 Pasos (5 minutos)

### En tu Raspberry Pi:

```bash
# Paso 1: Descargar script automÃ¡tico
curl -fsSL https://raw.githubusercontent.com/devandress/Estacion-metereologica/main/raspberry-pi-setup.sh -o setup.sh

# Paso 2: Ejecutar script
chmod +x setup.sh
./setup.sh

# El script instala automÃ¡ticamente:
# âœ… Docker y Docker Compose
# âœ… Tu proyecto
# âœ… Todas las dependencias
# âœ… Inicia los servicios
```

**Â¡Listo!** Tu sistema estarÃ¡ en:
- ğŸŒ Dashboard: `http://tu-rpi-ip:80`
- ğŸ”Œ API: `http://tu-rpi-ip:8000`

---

## ğŸ“Š Verificar que Funciona

```bash
# Ver estado de servicios
docker-compose ps

# Ver consumo en tiempo real
docker stats

# Ver logs
docker-compose logs -f
```

---

## ğŸŒ Acceso Remoto (Cloudflare Tunnel)

### ConfiguraciÃ³n AutomÃ¡tica:

```bash
cd /home/pi/weather_app

# Script de setup para Cloudflare
chmod +x setup-cloudflare-rpi.sh
./setup-cloudflare-rpi.sh

# Te pedirÃ¡:
# 1. Login en Cloudflare
# 2. Nombre del tunnel
# 3. Tu dominio Duck DNS
# 4. Â¡Listo! Acceso remoto sin abrir puertos
```

**URLs despuÃ©s de configurar:**
- ğŸŒ Dashboard: `https://tu-dominio.duckdns.org`
- ğŸ”Œ API: `https://api.tu-dominio.duckdns.org`

---

## ğŸ¯ Optimizaciones Aplicadas

### 1. Memoria - Uso Eficiente
```
PostgreSQL: 1GB lÃ­mite
Backend:   512MB lÃ­mite  
Nginx:     128MB lÃ­mite
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total:     1.6GB en uso
Disponible: 6.4GB libres âœ…
```

### 2. CPU - 4 Cores MÃ¡ximos
```
Gunicorn: 2 workers
Threads:  2 por worker
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: 4 hilos = 4 cores RPi âœ…
```

### 3. ImÃ¡genes Docker Ligeras
```
python:3.11-slim    â†’ 160MB
postgres:15-alpine  â†’ 200MB
nginx:alpine        â†’ 40MB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: 400MB vs 1.3GB estÃ¡ndar âœ…
```

### 4. JSON 3x MÃ¡s RÃ¡pido
```
orjson incluido â†’ SerializaciÃ³n mÃ¡s rÃ¡pida
Menos CPU = Menos calor en RPi âœ…
```

---

## ğŸ“ˆ Rendimiento Esperado

**En Reposo:**
- RAM: 400-500MB
- CPU: 5-10%
- Temperatura: 35-40Â°C

**Bajo Carga (20 requests/seg):**
- RAM: 1.2-1.5GB
- CPU: 30-50%
- Response: 50-100ms

**Capacidad MÃ¡xima:**
- Requests concurrentes: 20-50
- Datos por aÃ±o en BD: ~2GB

---

## ğŸ”§ Comandos Ãštiles

```bash
# Reiniciar servicios
docker-compose restart

# Ver logs en tiempo real
docker-compose logs -f backend

# Detener y parar
docker-compose down

# Actualizar proyecto
cd ~/weather_app
git pull origin main
docker-compose build
docker-compose up -d

# Ver consumo de CPU/RAM
docker stats --no-stream

# Limpiar espacio (if needed)
docker system prune -a
```

---

## ğŸ“š DocumentaciÃ³n Completa

Consulta estos archivos para mÃ¡s detalles:

1. **RASPBERRY_PI_8GB_SETUP.md**
   - GuÃ­a detallada de instalaciÃ³n
   - Troubleshooting
   - Escalado futuro

2. **README_ESP32_SETUP.md**
   - ConfiguraciÃ³n de sensores ESP32
   - CÃ³digo para cargar en ESP32
   - IntegraciÃ³n IoT

3. **ESP32_CLOUDFLARE_DUCKDNS.md**
   - GuÃ­a detallada de ESP32 + Cloudflare
   - ConexiÃ³n WiFi
   - EnvÃ­o de datos

4. **README.md**
   - DocumentaciÃ³n general del proyecto
   - API endpoints
   - Arquitectura

---

## âŒ Si Algo Falla

### No se inician los servicios
```bash
# Verificar logs
docker-compose logs

# Reintentar
docker-compose down
docker-compose up -d
```

### Consumo de memoria alto
```bash
# Ver quÃ© estÃ¡ usando RAM
docker stats

# Reiniciar servicio problemÃ¡tico
docker-compose restart [nombre-servicio]
```

### No hay conexiÃ³n a internet
```bash
# Verificar red desde RPi
ping -c 1 8.8.8.8

# Reiniciar docker
sudo systemctl restart docker
docker-compose restart
```

---

## âœ… Checklist Final

```
â–¡ Raspberry Pi conectada a red
â–¡ SSH funcionando
â–¡ Script de setup ejecutado exitosamente
â–¡ docker-compose ps muestra todos en "Up"
â–¡ Dashboard accesible en http://rpi-ip
â–¡ API responde en http://rpi-ip:8000/api/stations/
â–¡ docker stats muestra consumo < 1.5GB
â–¡ Cloudflare Tunnel configurado (opcional)
â–¡ ESP32 enviando datos (opcional)
```

---

## ğŸš€ PrÃ³ximos Pasos

1. **Conectar ESP32** (sensores meteorolÃ³gicos)
   - Ver [README_ESP32_SETUP.md](README_ESP32_SETUP.md)

2. **Configurar Cloudflare Tunnel** (acceso remoto)
   - Ver [ESP32_CLOUDFLARE_DUCKDNS.md](ESP32_CLOUDFLARE_DUCKDNS.md)

3. **Monitoreo en tiempo real**
   ```bash
   docker stats --no-stream
   watch -n 1 'docker stats --no-stream'
   ```

4. **Backups automÃ¡ticos** (prÃ³ximamente)

---

## ğŸ“ Soporte

- Proyecto: https://github.com/devandress/Estacion-metereologica
- Issues: GitHub Issues
- DocumentaciÃ³n: Archivos .md en el proyecto

---

**Â¡Tu sistema de estaciÃ³n meteorolÃ³gica estÃ¡ listo! ğŸ‰**

**Para iniciar:**
```bash
ssh pi@192.168.1.100
cd ~/weather_app
docker stats  # Ver que funcione
```

Accede a: **http://192.168.1.100**
